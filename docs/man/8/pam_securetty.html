<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>pam_securetty (8)</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&display=swap" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Geist+Mono:wght@100..900&family=Geist:wght@100..900&display=swap" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500;700&amp;display=swap" rel="stylesheet">
<link href="/man/index.css" rel="stylesheet" />
</head>
<body style="overscroll-behavior-x: auto">
<main>
<table class="head">
  <tr>
    <td class="head-ltitle">PAM_SECURETTY(8)</td>
    <td class="head-vol">Linux-PAM Manual</td>
    <td class="head-rtitle">PAM_SECURETTY(8)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">pam_securetty - Limit root login to special devices</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp HP"><b>pam_securetty.so</b> [debug]</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">pam_securetty is a PAM module that allows root logins only if the
    user is logging in on a &quot;secure&quot; tty, as defined by the listing in
    the securetty file. pam_securetty checks at first, if /etc/securetty exists.
    If not and it was built with vendordir support, it will use /securetty.
    pam_securetty also checks that the securetty files are plain files and not
    world writable. It will also allow root logins on the tty specified with
    <b>console=</b> switch on the kernel command line and on ttys from the
    /sys/class/tty/console/active.</p>
<p class="Pp">This module has no effect on non-root users and requires that the
    application fills in the <b>PAM_TTY</b> item correctly.</p>
<p class="Pp">For canonical usage, should be listed as a <b>required</b>
    authentication method before any <b>sufficient</b> authentication
  methods.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<p class="Pp">debug</p>
<div class="Bd-indent">Print debug information.</div>
<p class="Pp">noconsole</p>
<div class="Bd-indent">Do not automatically allow root logins on the kernel
  console device, as specified on the kernel command line or by the sys file, if
  it is not also specified in the securetty file.</div>
</section>
<section class="Sh">
<h1 class="Sh" id="MODULE_TYPES_PROVIDED"><a class="permalink" href="#MODULE_TYPES_PROVIDED">MODULE
  TYPES PROVIDED</a></h1>
<p class="Pp">Only the <b>auth</b> module type is provided.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="RETURN_VALUES"><a class="permalink" href="#RETURN_VALUES">RETURN
  VALUES</a></h1>
<p class="Pp">PAM_SUCCESS</p>
<div class="Bd-indent">The user is allowed to continue authentication. Either
  the user is not root, or the root user is trying to log in on an acceptable
  device.</div>
<p class="Pp">PAM_AUTH_ERR</p>
<div class="Bd-indent">Authentication is rejected. Either root is attempting to
  log in via an unacceptable device, or the securetty file is world writable or
  not a normal file.</div>
<p class="Pp">PAM_BUF_ERR</p>
<div class="Bd-indent">Memory buffer error.</div>
<p class="Pp">PAM_CONV_ERR</p>
<div class="Bd-indent">The conversation method supplied by the application
  failed to obtain the username.</div>
<p class="Pp">PAM_INCOMPLETE</p>
<div class="Bd-indent">The conversation method supplied by the application
  returned PAM_CONV_AGAIN.</div>
<p class="Pp">PAM_SERVICE_ERR</p>
<div class="Bd-indent">An error occurred while the module was determining the
  user's name or tty, or the module could not open the securetty file.</div>
<p class="Pp">PAM_USER_UNKNOWN</p>
<div class="Bd-indent">The module could not find the user name in the
  /etc/passwd file to verify whether the user had a UID of 0. Therefore, the
  results of running this module are ignored.</div>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<div class="Bd-indent">
<pre>auth  required  pam_securetty.so
auth  required  pam_unix.so
<br/>
      </pre>
</div>
<p class="Pp"></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><b>securetty</b>(5), <b>pam.conf</b>(5), <b>pam.d</b>(5),
    <b>pam</b>(7)</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">pam_securetty was written by Elliot Lee
  &lt;sopwith@cuc.edu&gt;.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">05/07/2023</td>
    <td class="foot-os">Linux-PAM</td>
  </tr>
</table>
</main>
</body>
</html>
