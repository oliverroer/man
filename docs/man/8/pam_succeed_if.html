<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>pam_succeed_if (8)</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500;700&amp;display=swap" rel="stylesheet">
<link href="/man/index.css" rel="stylesheet" />
</head>
<body style="overscroll-behavior-x: auto">
<main>
<table class="head">
  <tr>
    <td class="head-ltitle">PAM_SUCCEED_IF(8)</td>
    <td class="head-vol">Linux-PAM Manual</td>
    <td class="head-rtitle">PAM_SUCCEED_IF(8)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">pam_succeed_if - test account characteristics</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp HP"><b>pam_succeed_if.so</b> [<i>flag</i>...]
  [<i>condition</i>...]</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">pam_succeed_if.so is designed to succeed or fail authentication
    based on characteristics of the account belonging to the user being
    authenticated or values of other PAM items. One use is to select whether to
    load other modules based on this test.</p>
<p class="Pp">The module should be given one or more conditions as module
    arguments, and authentication will succeed only if all of the conditions are
    met.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<p class="Pp">The following <i>flag</i>s are supported:</p>
<p class="Pp">debug</p>
<div class="Bd-indent">Turns on debugging messages sent to syslog.</div>
<p class="Pp">use_uid</p>
<div class="Bd-indent">Evaluate conditions using the account of the user whose
  UID the application is running under instead of the user being
  authenticated.</div>
<p class="Pp">quiet</p>
<div class="Bd-indent">Don't log failure or success to the system log.</div>
<p class="Pp">quiet_fail</p>
<div class="Bd-indent">Don't log failure to the system log.</div>
<p class="Pp">quiet_success</p>
<div class="Bd-indent">Don't log success to the system log.</div>
<p class="Pp">audit</p>
<div class="Bd-indent">Log unknown users to the system log.</div>
<p class="Pp"><i>Condition</i>s are three words: a field, a test, and a value to
    test for.</p>
<p class="Pp">Available fields are <i>user</i>, <i>uid</i>, <i>gid</i>,
    <i>shell</i>, <i>home</i>, <i>ruser</i>, <i>rhost</i>, <i>tty</i> and
    <i>service</i>:</p>
<p class="Pp">field &lt; number</p>
<div class="Bd-indent">Field has a value numerically less than number.</div>
<p class="Pp">field &lt;= number</p>
<div class="Bd-indent">Field has a value numerically less than or equal to
  number.</div>
<p class="Pp">field eq number</p>
<div class="Bd-indent">Field has a value numerically equal to number.</div>
<p class="Pp">field &gt;= number</p>
<div class="Bd-indent">Field has a value numerically greater than or equal to
  number.</div>
<p class="Pp">field &gt; number</p>
<div class="Bd-indent">Field has a value numerically greater than number.</div>
<p class="Pp">field ne number</p>
<div class="Bd-indent">Field has a value numerically different from
  number.</div>
<p class="Pp">field = string</p>
<div class="Bd-indent">Field exactly matches the given string.</div>
<p class="Pp">field != string</p>
<div class="Bd-indent">Field does not match the given string.</div>
<p class="Pp">field =~ glob</p>
<div class="Bd-indent">Field matches the given glob.</div>
<p class="Pp">field !~ glob</p>
<div class="Bd-indent">Field does not match the given glob.</div>
<p class="Pp">field in item:item:...</p>
<div class="Bd-indent">Field is contained in the list of items separated by
  colons.</div>
<p class="Pp">field notin item:item:...</p>
<div class="Bd-indent">Field is not contained in the list of items separated by
  colons.</div>
<p class="Pp">user ingroup group[:group:....]</p>
<div class="Bd-indent">User is in given group(s).</div>
<p class="Pp">user notingroup group[:group:....]</p>
<div class="Bd-indent">User is not in given group(s).</div>
<p class="Pp">user innetgr netgroup</p>
<div class="Bd-indent">(user,host) is in given netgroup.</div>
<p class="Pp">user notinnetgr group</p>
<div class="Bd-indent">(user,host) is not in given netgroup.</div>
</section>
<section class="Sh">
<h1 class="Sh" id="MODULE_TYPES_PROVIDED"><a class="permalink" href="#MODULE_TYPES_PROVIDED">MODULE
  TYPES PROVIDED</a></h1>
<p class="Pp">All module types (<b>account</b>, <b>auth</b>, <b>password</b> and
    <b>session</b>) are provided.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="RETURN_VALUES"><a class="permalink" href="#RETURN_VALUES">RETURN
  VALUES</a></h1>
<p class="Pp">PAM_SUCCESS</p>
<div class="Bd-indent">The condition was true.</div>
<p class="Pp">PAM_AUTH_ERR</p>
<div class="Bd-indent">The condition was false.</div>
<p class="Pp">PAM_SERVICE_ERR</p>
<div class="Bd-indent">A service error occurred or the arguments can't be parsed
  correctly.</div>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<p class="Pp">To emulate the behaviour of <i>pam_wheel</i>, except there is no
    fallback to group 0 being only approximated by checking also the root group
    membership:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre>auth required pam_succeed_if.so quiet user ingroup wheel:root
<br/>
    </pre>
</div>
<p class="Pp">Given that the type matches, only loads the othermodule rule if
    the UID is over 500. Adjust the number after default to skip several
  rules.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre>type [default=1 success=ignore] pam_succeed_if.so quiet uid &gt; 500
type required othermodule.so arguments...
<br/>
    </pre>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><b>glob</b>(7), <b>pam</b>(7)</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">Nalin Dahyabhai &lt;nalin@redhat.com&gt;</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">05/07/2023</td>
    <td class="foot-os">Linux-PAM</td>
  </tr>
</table>
</main>
</body>
</html>
