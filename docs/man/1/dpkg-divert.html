<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>dpkg-divert (1)</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&display=swap" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Geist+Mono:wght@100..900&family=Geist:wght@100..900&display=swap" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500;700&amp;display=swap" rel="stylesheet">
<link href="/man/index.css" rel="stylesheet" />
</head>
<body style="overscroll-behavior-x: auto">
<main>
<table class="head">
  <tr>
    <td class="head-ltitle">dpkg-divert(1)</td>
    <td class="head-vol">dpkg suite</td>
    <td class="head-rtitle">dpkg-divert(1)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">dpkg-divert - override a package's version of a file</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><b>dpkg-divert</b> [<i>option</i>...] <i>command</i></p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><b>dpkg-divert</b> is the utility used to set up and update the
    list of diversions.</p>
<p class="Pp">File <i>diversions</i> are a way of forcing <b>dpkg</b>(1) not to
    install a file into its location, but to a <i>diverted</i> location.
    Diversions can be used through the package maintainer scripts to move a file
    away when it causes a conflict. System administrators can also use it to
    override some package's configuration file, or whenever some files (which
    aren't marked as &#x201C;conffiles&#x201D;) need to be preserved by
    <b>dpkg</b>, when installing a newer version of a package which contains
    those files.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COMMANDS"><a class="permalink" href="#COMMANDS">COMMANDS</a></h1>
<dl class="Bl-tag">
  <dt>[<b>--add</b>] <i>file</i></dt>
  <dd>Add a diversion for <i>file</i>. The file is currently not renamed, see
      <b>--rename</b>.</dd>
  <dt id="remove"><a class="permalink" href="#remove"><b>--remove</b>
    <i>file</i></a></dt>
  <dd>Remove a diversion for <i>file</i>. The file is currently not renamed, see
      <b>--rename</b>.</dd>
  <dt id="list"><a class="permalink" href="#list"><b>--list</b>
    [<i>glob-pattern</i>]</a></dt>
  <dd>List all diversions, or ones matching <i>glob-pattern</i>.</dd>
  <dt id="listpackage"><a class="permalink" href="#listpackage"><b>--listpackage</b>
    <i>file</i></a></dt>
  <dd>Print the name of the package that diverts <i>file</i> (since dpkg
      1.15.0). Prints LOCAL if <i>file</i> is locally diverted and nothing if
      <i>file</i> is not diverted.</dd>
  <dt id="truename"><a class="permalink" href="#truename"><b>--truename</b>
    <i>file</i></a></dt>
  <dd>Print the real name for a diverted file.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt id="admindir"><a class="permalink" href="#admindir"><b>--admindir</b>
    <i>directory</i></a></dt>
  <dd>Set the administrative directory to <i>directory</i>. Defaults to
      &#x00AB;<i>/var/lib/dpkg</i>&#x00BB; if <b>DPKG_ADMINDIR</b> has not been
      set.</dd>
  <dt id="instdir"><a class="permalink" href="#instdir"><b>--instdir</b>
    <i>directory</i></a></dt>
  <dd>Set the installation directory, which refers to the directory where
      packages get installed (since dpkg 1.19.2). Defaults to
      &#x00AB;<i>/</i>&#x00BB; if <b>DPKG_ROOT</b> has not been set.</dd>
  <dt id="root"><a class="permalink" href="#root"><b>--root</b>
    <i>directory</i></a></dt>
  <dd>Set the root directory to <b>directory</b>, which sets the installation
      directory to &#x00AB;<i>directory</i>&#x00BB; and the administrative
      directory to &#x00AB;<i>directory</i><b>/var/lib/dpkg</b>&#x00BB; (since
      dpkg 1.19.2) if <b>DPKG_ROOT</b> has not been set.</dd>
  <dt id="divert"><a class="permalink" href="#divert"><b>--divert</b>
    <i>divert-to</i></a></dt>
  <dd><i>divert-to</i> is the location where the versions of <i>file</i>, as
      provided by other packages, will be diverted.</dd>
  <dt id="local"><a class="permalink" href="#local"><b>--local</b></a></dt>
  <dd>Specifies that all packages' versions of this file are diverted. This
      means, that there are no exceptions, and whatever package is installed,
      the file is diverted. This can be used by an admin to install a locally
      modified version.</dd>
  <dt id="package"><a class="permalink" href="#package"><b>--package</b>
    <i>package</i></a></dt>
  <dd><i>package</i> is the name of a package whose copy of <i>file</i> will not
      be diverted. i.e. <i>file</i> will be diverted for all packages except
      <i>package</i>.</dd>
  <dt id="quiet"><a class="permalink" href="#quiet"><b>--quiet</b></a></dt>
  <dd>Quiet mode, i.e. no verbose output.</dd>
  <dt id="rename"><a class="permalink" href="#rename"><b>--rename</b></a></dt>
  <dd>Actually move the file aside (or back). <b>dpkg-divert</b> will abort
      operation in case the destination file already exists. This is the common
      behavior used for diversions of files from the non-<b>Essential</b>
      package set (see <b>--no-rename</b> for more details).</dd>
  <dt id="no"><a class="permalink" href="#no"><b>--no-rename</b></a></dt>
  <dd>Specifies that the file should not be renamed while adding or removing the
      diversion into the database (since dpkg 1.19.1). This is intended for
      diversions of files from the <b>Essential</b> package set, where the
      temporary disappearance of the original file is not acceptable, as it can
      render the system non-functional. This is the default behavior, but that
      will change in the dpkg 1.20.x cycle.</dd>
  <dt id="test"><a class="permalink" href="#test"><b>--test</b></a></dt>
  <dd>Test mode, i.e. don't actually perform any changes, just demonstrate.</dd>
  <dt><b>-?</b>, <b>--help</b></dt>
  <dd>Show the usage message and exit.</dd>
  <dt id="version"><a class="permalink" href="#version"><b>--version</b></a></dt>
  <dd>Show the version and exit.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXIT_STATUS"><a class="permalink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
<dl class="Bl-tag">
  <dt><b>0</b></dt>
  <dd>The requested action was successfully performed.</dd>
  <dt><b>2</b></dt>
  <dd>Fatal or unrecoverable error due to invalid command-line usage, or
      interactions with the system, such as accesses to the database, memory
      allocations, etc.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="ENVIRONMENT"><a class="permalink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<dl class="Bl-tag">
  <dt id="DPKG_ROOT"><a class="permalink" href="#DPKG_ROOT"><b>DPKG_ROOT</b></a></dt>
  <dd>If set and the <b>--instdir</b> or <b>--root</b> options have not been
      specified, it will be used as the filesystem root directory (since dpkg
      1.19.2).</dd>
  <dt id="DPKG_ADMINDIR"><a class="permalink" href="#DPKG_ADMINDIR"><b>DPKG_ADMINDIR</b></a></dt>
  <dd>If set and the <b>--admindir</b> or <b>--root</b> options have not been
      specified, it will be used as the <b>dpkg</b> data directory.</dd>
  <dt id="DPKG_MAINTSCRIPT_PACKAGE"><a class="permalink" href="#DPKG_MAINTSCRIPT_PACKAGE"><b>DPKG_MAINTSCRIPT_PACKAGE</b></a></dt>
  <dd>If set and the <b>--local</b> and <b>--package</b> options have not been
      specified, <b>dpkg-divert</b> will use it as the package name.</dd>
  <dt id="DPKG_DEBUG"><a class="permalink" href="#DPKG_DEBUG"><b>DPKG_DEBUG</b></a></dt>
  <dd>Sets the debug mask (since dpkg 1.21.10) from an octal value. The
      currently accepted flags are described in the <b>dpkg --debug</b> option,
      but not all these flags might have an effect on this program.</dd>
  <dt id="DPKG_COLORS"><a class="permalink" href="#DPKG_COLORS"><b>DPKG_COLORS</b></a></dt>
  <dd>Sets the color mode (since dpkg 1.18.5). The currently accepted values
      are: <b>auto</b> (default), <b>always</b> and <b>never</b>.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag">
  <dt><i>/var/lib/dpkg/diversions</i></dt>
  <dd>File which contains the current list of diversions of the system. It is
      located in the <b>dpkg</b> administration directory, along with other
      files important to <b>dpkg</b>, such as <i>status</i> or <i>available</i>.
    <p class="Pp"><b>Note</b>: <b>dpkg-divert</b> preserves the old copy of this
        file, with extension <i>-old</i>, before replacing it with the new
      one.</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="NOTES"><a class="permalink" href="#NOTES">NOTES</a></h1>
<p class="Pp">When adding, default is <b>--local</b> and <b>--divert</b>
    <i>original</i><b>.distrib</b>. When removing, <b>--package</b> or
    <b>--local</b> and <b>--divert</b> must match if specified.</p>
<p class="Pp">Directories can't be diverted with <b>dpkg-divert</b>.</p>
<p class="Pp">Care should be taken when diverting shared libraries,
    <b>ldconfig</b>(8) creates a symbolic link based on the DT_SONAME field
    embedded in the library. Because <b>ldconfig</b> does not honor diverts
    (only <b>dpkg</b> does), the symlink may end up pointing at the diverted
    library, if a diverted library has the same SONAME as the undiverted
  one.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<p class="Pp">To divert all copies of a <i>/usr/bin/example</i> to
    <i>/usr/bin/example.foo</i>, i.e. directs all packages providing
    <i>/usr/bin/example</i> to install it as <i>/usr/bin/example.foo</i>,
    performing the rename if required:</p>
<p class="Pp"></p>
<pre> dpkg-divert --divert /usr/bin/example.foo --rename /usr/bin/example
</pre>
<p class="Pp">To remove that diversion:</p>
<p class="Pp"></p>
<pre> dpkg-divert --rename --remove /usr/bin/example
</pre>
<p class="Pp">To divert any package trying to install <i>/usr/bin/example</i> to
    <i>/usr/bin/example.foo</i>, except your own <i>wibble</i> package:</p>
<p class="Pp"></p>
<pre> dpkg-divert --package wibble --divert /usr/bin/example.foo \
    --rename /usr/bin/example
</pre>
<p class="Pp">To remove that diversion:</p>
<p class="Pp"></p>
<pre> dpkg-divert --package wibble --rename --remove /usr/bin/example
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><b>dpkg</b>(1).</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2024-07-17</td>
    <td class="foot-os">1.22.6</td>
  </tr>
</table>
</main>
</body>
</html>
